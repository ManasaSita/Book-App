{"ast":null,"code":"// Friends.js\nimport React,{useEffect,useState}from'react';import{useAuth}from'../context/AuthContext';import{fetchFriends,searchUsers,sendFriendRequest,fetchFriendRequests,respondToFriendRequest}from'../services/api';import FriendProfile from'./FriendProfile';import Notification from'./Notification';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const Friends=()=>{const[friends,setFriends]=useState([]);const[searchTerm,setSearchTerm]=useState('');const[searchResults,setSearchResults]=useState([]);const[selectedFriendId,setSelectedFriendId]=useState(null);const[requests,setRequests]=useState([]);const senderId=useAuth().user.payload.user.id;const[showNotification,setShowNotification]=useState(false);useEffect(()=>{const fetchFriendsData=async()=>{try{const response=await fetchFriends(senderId);setFriends(response);}catch(error){console.error('Error fetching friends:',error);}};const fetchRequests=async()=>{try{const response=await fetchFriendRequests();setRequests(response.receivedRequests);}catch(error){console.error('Error fetching friend requests:',error);}};fetchRequests();fetchFriendsData();},[]);const handleSearch=async e=>{e.preventDefault();try{const response=await searchUsers(searchTerm);setSearchResults(response);}catch(error){console.error('Error searching users:',error);}};const handleSendRequest=async receiverId=>{try{await sendFriendRequest(receiverId,senderId);setShowNotification(true);setTimeout(()=>setShowNotification(false),3000);setSearchTerm('');}catch(error){console.error('Error sending friend request:',error);}};const handleFriendClick=friendId=>{setSelectedFriendId(friendId);};return/*#__PURE__*/_jsxs(\"div\",{className:\"friends-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"friends-list\",children:[/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSearch,className:\"search-container-friend\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Search for users...\",value:searchTerm,onChange:e=>setSearchTerm(e.target.value)}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Search\"})]}),searchResults&&searchResults.length>0?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Search Results\"}),/*#__PURE__*/_jsx(\"ul\",{children:searchResults.map(user=>/*#__PURE__*/_jsxs(\"li\",{children:[user.username,/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleSendRequest(user._id),children:\"Add Friend\"}),showNotification&&/*#__PURE__*/_jsx(Notification,{message:\"Friend Request sent!\",onClose:()=>setShowNotification(false)})]},user._id))})]}):/*#__PURE__*/_jsx(_Fragment,{})// <p>No results found.</p>\n,/*#__PURE__*/_jsx(\"h1\",{children:\"Your Friends\"}),/*#__PURE__*/_jsx(\"ul\",{children:friends.map(friend=>/*#__PURE__*/_jsx(\"li\",{onClick:()=>handleFriendClick(friend._id),className:friend._id===selectedFriendId?'selected-friend':'',children:friend.username},friend._id))})]}),/*#__PURE__*/_jsx(\"div\",{className:\"friend-profile-or-chat\",children:selectedFriendId?/*#__PURE__*/_jsx(FriendProfile,{friendId:selectedFriendId}):/*#__PURE__*/_jsx(\"p\",{children:\"Select a friend to view their profile\"})})]});};export default Friends;","map":{"version":3,"names":["React","useEffect","useState","useAuth","fetchFriends","searchUsers","sendFriendRequest","fetchFriendRequests","respondToFriendRequest","FriendProfile","Notification","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Friends","friends","setFriends","searchTerm","setSearchTerm","searchResults","setSearchResults","selectedFriendId","setSelectedFriendId","requests","setRequests","senderId","user","payload","id","showNotification","setShowNotification","fetchFriendsData","response","error","console","fetchRequests","receivedRequests","handleSearch","e","preventDefault","handleSendRequest","receiverId","setTimeout","handleFriendClick","friendId","className","children","onSubmit","type","placeholder","value","onChange","target","length","map","username","onClick","_id","message","onClose","friend"],"sources":["/home/manasa/Projects/UpGrad/Project/bookShelf/client/src/components/Friends.js"],"sourcesContent":["// Friends.js\nimport React, { useEffect, useState } from 'react';\nimport { useAuth } from '../context/AuthContext';\nimport { fetchFriends, searchUsers, sendFriendRequest, fetchFriendRequests, respondToFriendRequest } from '../services/api';\nimport FriendProfile from './FriendProfile';\nimport Notification from './Notification';\n\nconst Friends = () => {\n  const [friends, setFriends] = useState([]);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [searchResults, setSearchResults] = useState([]);\n  const [selectedFriendId, setSelectedFriendId] = useState(null);\n  const [requests, setRequests] = useState([]);\n  const senderId = useAuth().user.payload.user.id;\n  const [showNotification, setShowNotification] = useState(false);\n\n  useEffect(() => {\n    const fetchFriendsData = async () => {\n      try {\n        const response = await fetchFriends(senderId);\n        setFriends(response);\n      } catch (error) {\n        console.error('Error fetching friends:', error);\n      }\n    };\n\n    const fetchRequests = async () => {\n      try {\n        const response = await fetchFriendRequests();\n        setRequests(response.receivedRequests);\n      } catch (error) {\n        console.error('Error fetching friend requests:', error);\n      }\n    };\n\n    fetchRequests();\n    fetchFriendsData();\n  }, []);\n\n  const handleSearch = async (e) => {\n    e.preventDefault();\n    try {\n      const response = await searchUsers(searchTerm);\n      setSearchResults(response);\n    } catch (error) {\n      console.error('Error searching users:', error);\n    }\n  };\n\n  const handleSendRequest = async (receiverId) => {\n    try {\n      await sendFriendRequest(receiverId, senderId);\n      setShowNotification(true);\n      setTimeout(() => setShowNotification(false), 3000);\n      setSearchTerm('')\n    } catch (error) {\n      console.error('Error sending friend request:', error);\n    }\n  };\n\n  const handleFriendClick = (friendId) => {\n    setSelectedFriendId(friendId);\n  };\n\n  return (\n    <div className=\"friends-container\">\n      <div className=\"friends-list\">\n        <form onSubmit={handleSearch} className='search-container-friend'>\n          <input\n            type=\"text\"\n            placeholder=\"Search for users...\"\n            value={searchTerm}\n            onChange={(e) => setSearchTerm(e.target.value)}\n          />\n          <button type=\"submit\">Search</button>\n        </form>\n\n        {searchResults && searchResults.length > 0 ? (\n          <>\n            <h2>Search Results</h2>\n            <ul>\n              {searchResults.map(user => (\n                <li key={user._id}>\n                  {user.username}\n                  <button onClick={() => handleSendRequest(user._id)}>Add Friend</button>\n                  {showNotification && (\n                    <Notification\n                      message=\"Friend Request sent!\"\n                      onClose={() => setShowNotification(false)}\n                    />\n                  )}\n                </li>\n              ))}\n            </ul>\n          </>\n        ) : (\n          <></>\n          // <p>No results found.</p>\n        )}\n\n        <h1>Your Friends</h1>\n        <ul>\n          {friends.map(friend => (\n            <li\n              key={friend._id}\n              onClick={() => handleFriendClick(friend._id)}\n              className={friend._id === selectedFriendId ? 'selected-friend' : ''}\n            >\n              {friend.username}\n            </li>\n          ))}\n        </ul>\n      </div>\n      <div className=\"friend-profile-or-chat\">\n        {selectedFriendId ? (\n          <FriendProfile friendId={selectedFriendId} />\n        ) : (\n          <p>Select a friend to view their profile</p>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default Friends;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}