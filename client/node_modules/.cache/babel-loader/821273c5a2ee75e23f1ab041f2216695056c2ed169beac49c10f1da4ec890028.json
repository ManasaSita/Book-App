{"ast":null,"code":"import React,{useState,useEffect,useRef}from'react';import{useAuth}from'../context/AuthContext';import{sendMessage,fetchMessages}from'../services/api';import{jsxs as _jsxs,jsx as _jsx}from\"react/jsx-runtime\";const Chat=_ref=>{let{friend}=_ref;const[messages,setMessages]=useState([]);const[newMessage,setNewMessage]=useState('');const{user}=useAuth();const sender=user.payload.user.username;const senderId=user.payload.user.id;const messagesEndRef=useRef(null);const scrollToBottom=()=>{var _messagesEndRef$curre;(_messagesEndRef$curre=messagesEndRef.current)===null||_messagesEndRef$curre===void 0?void 0:_messagesEndRef$curre.scrollIntoView({behavior:\"smooth\"});};useEffect(()=>{const loadMessages=async()=>{try{const fetchedMessages=await fetchMessages(senderId,friend._id);setMessages(fetchedMessages);}catch(error){console.error('Error fetching messages:',error);}};loadMessages();},[friend._id,senderId]);useEffect(scrollToBottom,[messages]);const handleSendMessage=async e=>{e.preventDefault();try{const messageData={senderId:senderId,friendId:friend._id,content:newMessage};const sentMessage=await sendMessage(messageData);setMessages([...messages,sentMessage]);setNewMessage('');}catch(error){console.error('Error sending message:',error);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"chat-container\",children:[/*#__PURE__*/_jsxs(\"h2\",{children:[\"Chat with \",friend.username]}),/*#__PURE__*/_jsx(\"div\",{className:\"messages-wrapper\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"messages\",children:[messages.length>0?messages.map((message,index)=>/*#__PURE__*/_jsx(\"div\",{className:`message ${message.sender===senderId?'sent':'received'}`,children:/*#__PURE__*/_jsx(\"span\",{className:\"message-content\",children:message.content})},index)):/*#__PURE__*/_jsx(\"div\",{className:\"no-messages\",children:/*#__PURE__*/_jsx(\"p\",{children:\"Send Hi..!\"})}),/*#__PURE__*/_jsx(\"div\",{ref:messagesEndRef})]})}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSendMessage,className:\"send-message-form\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:newMessage,onChange:e=>setNewMessage(e.target.value),placeholder:\"Type your message...\",required:true}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Send\"})]})]});};export default Chat;","map":{"version":3,"names":["React","useState","useEffect","useRef","useAuth","sendMessage","fetchMessages","jsxs","_jsxs","jsx","_jsx","Chat","_ref","friend","messages","setMessages","newMessage","setNewMessage","user","sender","payload","username","senderId","id","messagesEndRef","scrollToBottom","_messagesEndRef$curre","current","scrollIntoView","behavior","loadMessages","fetchedMessages","_id","error","console","handleSendMessage","e","preventDefault","messageData","friendId","content","sentMessage","className","children","length","map","message","index","ref","onSubmit","type","value","onChange","target","placeholder","required"],"sources":["/home/manasa/Projects/UpGrad/Project/bookShelf/client/src/components/Chat.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { useAuth } from '../context/AuthContext';\nimport { sendMessage, fetchMessages } from '../services/api';\n\nconst Chat = ({ friend }) => {\n  const [messages, setMessages] = useState([]);\n  const [newMessage, setNewMessage] = useState('');\n  const { user } = useAuth();\n  const sender = user.payload.user.username;\n  const senderId = user.payload.user.id;\n  const messagesEndRef = useRef(null);\n\n  const scrollToBottom = () => {\n    messagesEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\n  }\n\n  useEffect(() => {\n    const loadMessages = async () => {\n      try {\n        const fetchedMessages = await fetchMessages(senderId, friend._id);\n        setMessages(fetchedMessages);\n      } catch (error) {\n        console.error('Error fetching messages:', error);\n      }\n    };\n\n    loadMessages();\n  }, [friend._id, senderId]);\n\n  useEffect(scrollToBottom, [messages]);\n\n  const handleSendMessage = async (e) => {\n    e.preventDefault();\n    try {\n      const messageData = { senderId: senderId, friendId: friend._id, content: newMessage };\n      const sentMessage = await sendMessage(messageData);\n      setMessages([...messages, sentMessage]);\n      setNewMessage('');\n    } catch (error) {\n      console.error('Error sending message:', error);\n    }\n  };\n\n  return (\n    <div className=\"chat-container\">\n      <h2>Chat with {friend.username}</h2>\n      <div className=\"messages-wrapper\">\n        <div className=\"messages\">\n          {messages.length > 0 ? (\n            messages.map((message, index) => (\n              <div\n                key={index}\n                className={`message ${message.sender === senderId ? 'sent' : 'received'}`}\n              >\n                {/* <strong>\n                  {message.sender === senderId ? sender : friend.username}:\n                </strong> */}\n                <span className=\"message-content\">{message.content}</span>\n              </div>\n            ))\n          ) : (\n            <div className=\"no-messages\">\n              <p>Send Hi..!</p>\n            </div>\n          )}\n          <div ref={messagesEndRef} />\n        </div>\n      </div>\n      <form onSubmit={handleSendMessage} className=\"send-message-form\">\n        <input\n          type=\"text\"\n          value={newMessage}\n          onChange={(e) => setNewMessage(e.target.value)}\n          placeholder=\"Type your message...\"\n          required\n        />\n        <button type=\"submit\">Send</button>\n      </form>\n    </div>\n  );\n};\n\nexport default Chat;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}